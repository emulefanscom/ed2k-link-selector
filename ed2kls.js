/*!
 * eD2k Link Selector JavaScript
 * by Tom Chen
 * https://emulefans.com/wordpress-ed2k-link-selector/
 * GPL v2
 */
!function(){function r(e){return document.getElementById(e)}function d(e){return document.getElementsByName(e)}function l(e,n,t){t=t||document,n=n||"*";var l=[];if(document.getElementsByClassName&&Array.filter){if("*"==n)return t.getElementsByClassName(e);l=Array.filter(t.getElementsByClassName(e),function(e){return e.tagName==n.toUpperCase()})}else for(var i=t.getElementsByTagName(n),s=new RegExp("(^|\\s)"+e+"(\\s|$)"),c=0,o=0,a=i.length;c<a;c++)s.test(i[c].className)&&(l[o]=i[c],o++);return l}function i(n,e,t){null!==n&&(n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent&&n.attachEvent("on"+e,function(e){t.call(n,e)}))}function a(e,n){for(var t=e.firstChild;null!==t;t=t.nextSibling)if(3==t.nodeType)return t.nodeValue=n,!0;return!1}function s(e,n){var t=r("el-s-info-"+e),l=r("el-s-info-content-"+e);l.innerHTML="";var i=r("el-s-info-content-str-"+n).cloneNode(!0);i.id="",l.appendChild(i),"none"==t.style.display&&("undefined"==typeof jQuery?t.style.display="block":jQuery(t).slideDown(300))}function f(e){return decodeURIComponent(e).split("|")[2]}function v(e){return+decodeURIComponent(e).split("|")[3]}function u(e){if(r("el-s-namefilter-"+e)){r("el-s-namefilter-"+e).value="";var n=d("el-s-chktype-"+e+"[]");g(n,function(e){e.checked=!1})}r("el-s-sizesymbol-"+e+"-1")&&(r("el-s-sizesymbol-"+e+"-1").selectedIndex=0,r("el-s-sizefilter-"+e+"-1").value="",r("el-s-sizeunit-"+e+"-1").selectedIndex=0,r("el-s-sizesymbol-"+e+"-2").selectedIndex=0,r("el-s-sizefilter-"+e+"-2").value="",r("el-s-sizeunit-"+e+"-2").selectedIndex=0)}function p(e){for(var n=!!r("el-s-totsize-"+e),t=d("el-s-chkbx-"+e+"[]"),l=t.length,i=0,s=0,c=r("el-s-chkall-"+e),o=0;o<l;o++)t[o].checked&&(n&&(i+=v(t[o].value)),s++);c.checked=s==l,n&&a(r("el-s-totsize-"+e),function(e){var n=100,t=ed2klsVar.bytes;return 1099511627776<=e?(e=Math.round(e/10995116277.76)/n,t=ed2klsVar.tb):1073741824<=e?(e=Math.round(e/10737418.24)/n,t=ed2klsVar.gb):1048576<=e?(e=Math.round(e/10485.76)/n,t=ed2klsVar.mb):1024<=e&&(e=Math.round(e/10.24)/n,t=ed2klsVar.kb),e+t}(i)),a(r("el-s-totnum-"+e),s)}function m(e,n,t,l){if(""===t||void 0===t)return!0;var i=t*l;switch(n){case"1":if(i<e)return!0;break;case"2":if(e<i)return!0;break;default:return!0}return!1}function c(e){k(e),n(e),p(e)}function o(e,n){var t=d("el-s-chkbx-"+e+"[]"),l="";g(t,function(e){e.checked&&(1==n?l+=f(e.value)+"\n":2==n&&(l+=e.value+"\n"))}),function(e){var n=document.createElement("textarea");n.value=e,n.setAttribute("readonly",""),n.style.position="absolute",n.style.left="-9999px",document.body.appendChild(n);var t=0<document.getSelection().rangeCount&&document.getSelection().getRangeAt(0);n.select(),document.execCommand("copy"),document.body.removeChild(n),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))}(l)}function h(e){var n=d("el-s-chkbx-"+e+"[]"),t="# eMule Collection (Simple Text Format). Created by eD2k Link Selector WordPress Plugin (emulefans.com)\n";g(n,function(e){e.checked&&(t+=e.value+"\n")}),function(e,n,t){var l=document.createElement("a"),i=new Blob([e],{type:t});if(document.body.appendChild(l),l.style="display: none",window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,n);else{var s=(window.URL||window.webkitURL).createObjectURL(i);l.href=s,l.download=n,l.click(),(window.URL||window.webkitURL).revokeObjectURL(s)}document.body.removeChild(l)}(t,f(n[0].value)+"_"+(new Date).toISOString().replace(/\D/g,"")+".emulecollection","application/octetstream")}var y=-1,k=function(e){var n,t,l,i,s,c,o,a;r("el-s-namefilter-"+e)&&(n=r("el-s-namefilter-"+e),t=n.value),r("el-s-sizesymbol-"+e+"-1")&&(l=(l=r("el-s-sizesymbol-"+e+"-1")).options[l.selectedIndex].value,i=r("el-s-sizefilter-"+e+"-1").value,s=(s=r("el-s-sizeunit-"+e+"-1")).options[s.selectedIndex].value,c=(c=r("el-s-sizesymbol-"+e+"-2")).options[c.selectedIndex].value,o=r("el-s-sizefilter-"+e+"-2").value,a=(a=r("el-s-sizeunit-"+e+"-2")).options[a.selectedIndex].value);var u=d("el-s-chkbx-"+e+"[]");g(u,function(e){e.checked=!!(function(e,n){if(""===e||void 0===e||""===n)return!0;for(var t=(e=(e=e.replace(/"(.+?)"/g,function(e){return e=(e=e.substr(1,e.length-2)).replace(/\s/g,"\\u0020").replace(/\+/g,"\\u002B").replace(/-/g,"\\u002D").replace(/\|/g,"\\u007C").replace(/\^/g,"\\u005E").replace(/\$/g,"\\u0024")})).replace(/[\s+)]*-/g," -").replace(/\|\s-/g,"|-").replace(/([\\.{}[\]()*+?])/g,"\\$1").replace(/\\(\\u[0-9A-F]{4})/g,"$1")).split(/[\s+]+/),l=0,i=t.length;l<i;l++){var s=t[l];if(""!==s)if(/\|/.test(s)){for(var c=s.split("|"),o=!1,a=0,u=c.length;a<u;a++){var r=c[a];""!==r&&("-"!=r.charAt(0)&&!0===new RegExp(r,"i").test(n)||"-"==r.charAt(0)&&!1===new RegExp(r.substr(1,r.length-1),"i").test(n))&&(o=!0)}if(!1===o)return!1}else if("-"!=s.charAt(0)&&!1===new RegExp(s,"i").test(n)||"-"==s.charAt(0)&&!0===new RegExp(s.substr(1,s.length-1),"i").test(n))return!1}return!0}(t,f(e.value))&&m(v(e.value),l,i,s)&&m(v(e.value),c,o,a))})},n=function(e){if(r("el-s-namefilter-"+e)){var n,t,l=d("el-s-chktype-"+e+"[]"),i=r("el-s-namefilter-"+e).value;g(l,function(e){t=e.value,n=new RegExp("\\."+t+"\\$","i"),e.checked=!!n.test(i)})}},g=function(e,n){for(var t=0,l=e.length;t<l;t++)n(e[t],t,e)};i(window,"load",function(){!function(){var e=l("el-s-namefilter","input").concat(l("el-s-sizefilter","input"));g(e,function(e){e.value=""});var n=l("el-s-chkbx","input");g(n,function(e){/el-s-chktype/.test(e.className)?e.checked=!1:e.checked=!0})}();var e=l("el-s");g(e,function(e){var n=e.id.match(/el-s-(\d+)/)[1],t=r("el-s-chkall-"+n);i(t,"click",function(){!function(e,n){var t=d("el-s-chkbx-"+e+"[]");g(t,function(e){e.checked=n}),p(e),u(e)}(n,t.checked)}),i(r("el-s-help-"+n),"click",function(){s(n,0)}),i(r("el-s-namefilterhelp-"+n),"click",function(){s(n,1)}),i(r("el-s-sizefilterhelp-"+n),"click",function(){s(n,2)}),i(r("el-s-info-close-"+n),"click",function(){!function(e){"undefined"==typeof jQuery?r("el-s-info-"+e).style.display="none":jQuery(r("el-s-info-"+e)).slideUp(300)}(n)}),i(r("el-s-exd-"+n),"click",function(){!function(e){var n=r("el-s-tb-"+e),t=r("el-s-exd-"+e);if("none"==n.style.display){if(a(t,"[-]"),"undefined"==typeof jQuery||jQuery.browser.msie){var l=navigator.appVersion.match(/MSIE (\d+\.\d+)/,"");null!==l&&Number(l[1])<=8?n.style.display="block":n.style.display="table-row-group"}else jQuery(n).fadeIn("slow");t.setAttribute("title",ed2klsVar.shk)}else a(t,"[+]"),"undefined"==typeof jQuery||jQuery.browser.msie?n.style.display="none":jQuery(n).fadeOut("slow"),t.setAttribute("title",ed2klsVar.exd)}(n)}),i(r("el-s-namefilter-"+n),"keyup",function(){c(n)}),i(r("el-s-sizesymbol-"+n+"-1"),"change",function(){c(n)}),i(r("el-s-sizefilter-"+n+"-1"),"keyup",function(){c(n)}),i(r("el-s-sizeunit-"+n+"-1"),"change",function(){c(n)}),i(r("el-s-sizesymbol-"+n+"-2"),"change",function(){c(n)}),i(r("el-s-sizefilter-"+n+"-2"),"keyup",function(){c(n)}),i(r("el-s-sizeunit-"+n+"-2"),"change",function(){c(n)}),i(r("el-s-download-"+n),"click",function(){!function(e){var n=d("el-s-chkbx-"+e+"[]"),t=[];g(n,function(e){e.checked&&t.push(e.value)});var l=t.length;if(0===l)return;var i=6e3,s=0,c=function(){window.location=t[s],s<l-1&&(s++,window.setTimeout(function(){i=500,c()},i))};c()}(n)}),i(r("el-s-copylinks-"+n),"click",function(){o(n,2)}),i(r("el-s-copynames-"+n),"click",function(){o(n,1)}),i(r("el-s-submit-"+n),"click",function(){h(n)}),g(l("el-s-chkbx-ed2k-"+n,"input",e),function(e){i(e,"click",function(e){!function(e,n){var t=n||window.event,l=(t.target||t.srcElement).id;if(l=l.substr(l.lastIndexOf("-")+1),l-=1,t.shiftKey)for(var i=d("el-s-chkbx-"+e+"[]"),s=Math.min(l,y),c=Math.max(l,y),o=s+1;o<=c-1;o++)i[o].checked=!i[o].checked;else y=l;p(e),u(e)}(n,e)})}),g(l("el-s-chktype-"+n,"input",e),function(e){i(e,"click",function(){!function(e,n,t){var l=r("el-s-namefilter-"+e),i=/(\.\S+?\$)(\|\.\S+?\$)*/i,s=new RegExp("\\|\\."+n+"\\$|\\."+n+"\\$\\||\\."+n+"\\$","i");l.value=l.value.replace(s,""),t&&(i.test(l.value)?l.value=l.value.replace(i,"$&|."+n+"$"):(""!==l.value&&" "!==l.value.substr(l.value.length-1,1)&&(l.value+=" "),l.value+="."+n+"$")),k(e),p(e)}(n,e.value,e.checked)})})})})}();