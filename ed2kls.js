// ed2k link selector javascript
// by tomchen1989
// http://emule-fans.com/wordpress-ed2k-link-selector/
// CC-BY-NC-SA
function $id(a){return document.getElementById(a)}function $nm(a){return document.getElementsByName(a)}function $cl(a,b,c){if(!c){c=document}if(!b){b="*"}var d=c.getElementsByTagName(b);var e=[];for(var i=0;i<d.length;i++){if(d[i].className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))){e.push(d[i])}}return e}var ed2kls={help:function(a,b){var c=$id("el-s-info-"+a);if(c.style.display=="none"){if(typeof jQuery=='undefined'){c.style.display="block"}else{jQuery(c).slideDown(300)}}var d=$cl("el-s-info-content","div",c);for(var i=0;i<d.length;i++){d[i].style.display=(i==b)?"block":"none"}this.cb.init()},closeinfo:function(a){if(typeof jQuery=='undefined'){$id("el-s-info-"+a).style.display="none"}else{jQuery($id("el-s-info-"+a)).slideUp(300)}this.cb.init()},close:function(a){var b=$id("el-s-tb-"+a);var c=$id("el-s-exd-"+a);if(typeof jQuery!='undefined'&&!jQuery.browser.msie){b=jQuery(b);if(b.css("display")=="none"){b.fadeIn("slow");jQuery(c).html("[-]");jQuery(c).attr("title",ed2klsStr.shk[a])}else{b.fadeOut("slow");jQuery(c).html("[+]");jQuery(c).attr("title",ed2klsStr.exd[a])}}else{if(b.style.display=="none"){b.style.display="table-row-group";c.innerHTML="[-]";c.setAttribute("title",ed2klsStr.shk[a])}else{b.style.display="none";c.innerHTML="[+]";c.setAttribute("title",ed2klsStr.exd[a])}}this.cb.init()},cb:{main:function(d,e){var f=new ZeroClipboard.Client();var g=false;f.setHandCursor(true);f.addEventListener("load",function(a){g=true});f.addEventListener("mouseOver",function(b){var a=$nm("el-s-chkbx-"+e);var n=a.length;var c="";for(var i=0;i<n;i++){if(a[i].checked){if(d==1){c+=ed2kls.getName(a[i].value)+"\n"}else if(d==2){c+=a[i].value+"\n"}}}f.setText(c)});f.addEventListener("complete",function(a,b){var c=$id("el-s-copied-"+e);if(!g){alert(ed2klsStr.retry[e])}else{c.style.display="inline";window.setTimeout(function(){c.style.display="none"},1000)}});if(d==1){f.glue("el-s-copynames-"+e)}else if(d==2){f.glue("el-s-copylinks-"+e)}},init:function(){var a=$cl("ZeroClipboard_ED2k","embed");for(var j=0;j<a.length;j++){var b=a[j].parentNode;b.parentNode.removeChild(b)}var c=$cl("el-s-copylinks","div");var n=c.length;var d;for(var i=0;i<n;i++){d=c[i].id;d=d.substr(d.lastIndexOf("-")+1);if($id("el-s-totsize-"+d)){this.main(1,d)}this.main(2,d)}},exe:function(){if(window.addEventListener){window.addEventListener("load",function(){ed2kls.cb.init()},false)}},iecopy:function(b,c){if(!window.addEventListener){var a=$nm("el-s-chkbx-"+c);var n=a.length;var d="";for(var i=0;i<n;i++){if(a[i].checked){if(b==1){d+=ed2kls.getName(a[i].value)+"\n"}else if(b==2){d+=a[i].value+"\n"}}}window.clipboardData.setData("Text",d);var e=$id("el-s-copied-"+c);e.style.display="inline";window.setTimeout(function(){e.style.display="none"},1000)}else{this.init();alert(ed2klsStr.retry[c])}}},formatSize:function(a,b){var c=100;var d=ed2klsStr.bytes[b];if(a>=1099511627776){a=Math.round(a/(1099511627776/c))/c;d=ed2klsStr.tb[b]}else if(a>=1073741824){a=Math.round(a/(1073741824/c))/c;d=ed2klsStr.gb[b]}else if(a>=1048576){a=Math.round(a/(1048576/c))/c;d=ed2klsStr.mb[b]}else if(a>=1024){a=Math.round(a/(1024/c))/c;d=ed2klsStr.kb[b]}return a+d},getName:function(a){var b;b=decodeURIComponent(a);b=b.split("|")[2];return b},getSize:function(a){var b;b=decodeURIComponent(a);b=+b.split("|")[3];return b},clear:function(a){if($id("el-s-namefilter-"+a)){$id("el-s-namefilter-"+a).value="";$id("el-s-sizesymbol-"+a+"-1").selectedIndex=0;$id("el-s-sizefilter-"+a+"-1").value="";$id("el-s-sizeunit-"+a+"-1").selectedIndex=0;$id("el-s-sizesymbol-"+a+"-2").selectedIndex=0;$id("el-s-sizefilter-"+a+"-2").value="";$id("el-s-sizeunit-"+a+"-2").selectedIndex=0;var b=$nm("el-s-chktype-"+a);var n=b.length;for(var i=0;i<n;i++){b[i].checked=false}}},total:function(b){var c=($id("el-s-totsize-"+b))?true:false;var a=$nm("el-s-chkbx-"+b);var n=a.length;if(c){var d=0}var e=0;var f=$id("el-s-chkall-"+b);for(var i=0;i<n;i++){if(a[i].checked){if(c){d+=this.getSize(a[i].value)}e++}}f.checked=(e==n)?true:false;if(c){$id("el-s-totsize-"+b).innerHTML=this.formatSize(d,b)}$id("el-s-totnum-"+b).innerHTML=e},initChk:-1,checkIt:function(a,b){var c=b||window.event;var d=c.target||c.srcElement;tarNum=d.id;tarNum=tarNum.substr(tarNum.lastIndexOf("-")+1);tarNum=tarNum-1;if(!c.shiftKey){this.initChk=tarNum}else{var e=$nm("el-s-chkbx-"+a);var f=e.length;var g=Math.min(tarNum,this.initChk);var h=Math.max(tarNum,this.initChk);for(var i=g+1;i<=h-1;i++){e[i].checked=e[i].checked?false:true}}this.total(a);this.clear(a)},checkAll:function(b,c){var a=$nm("el-s-chkbx-"+b);var n=a.length;for(var i=0;i<n;i++){a[i].checked=c}this.total(b);this.clear(b)},download:function(b){var a=$nm("el-s-chkbx-"+b);var n=a.length;var c=[];for(var i=0;i<n;i++){if(a[i].checked){c.push(a[i].value)}}var d=6000;var j=0;var e=function(){window.location=c[j];if(j<c.length-1){j++;window.setTimeout(function(){d=500;e()},d)}};e()},test:function(b,c){if(b===""||b===undefined||c===""){return true}b=b.replace(/\"(.+?)\"/g,function(a){a=a.substr(1,a.length-2);a=a.replace(/\s/g,"\\u0020").replace(/\+/g,"\\u002B").replace(/-/g,"\\u002D").replace(/\|/g,"\\u007C").replace(/\^/g,"\\u005E").replace(/\$/g,"\\u0024");return a});b=b.replace(/[\s\+)]*\-/g," -").replace(/\|\s-/g,"|-").replace(/([\\\.\{\}\[\]\(\)\*\+\?])/g,"\\$1").replace(/\\(\\u[0-9A-F]{4})/g,"$1");var d=b.split(/[\s\+]+/);for(var i=0;i<d.length;i++){var e=d[i];if(e!==""){if(/\|/.test(e)){var f=e.split("|");var g=false;for(var j=0;j<f.length;j++){var h=f[j];if(h!==""){if((h.charAt(0)!="-"&&new RegExp(h,"i").test(c)===true)||(h.charAt(0)=="-"&&new RegExp(h.substr(1,h.length-1),"i").test(c)===false)){g=true}}}if(g===false){return false}}else if((e.charAt(0)!="-"&&new RegExp(e,"i").test(c)===false)||(e.charAt(0)=="-"&&new RegExp(e.substr(1,e.length-1),"i").test(c)===true)){return false}}}return true},testSize:function(a,b,c,d){if(c===""){return true}else{var e=c*d;switch(b){case"1":if(a>e){return true}break;case"2":if(a<e){return true}break;default:return true}return false}},filter:function(a){this.filterRun(a);this.setChktype(a);this.total(a)},filterRun:function(b){if($id("el-s-namefilter-"+b)){var c=$id("el-s-namefilter-"+b);var d=c.value}if($id("el-s-sizesymbol-"+b+"-1")){var e=$id("el-s-sizesymbol-"+b+"-1");e=e.options[e.selectedIndex].value;var f=$id("el-s-sizefilter-"+b+"-1").value;var g=$id("el-s-sizeunit-"+b+"-1");g=g.options[g.selectedIndex].value;var h=$id("el-s-sizesymbol-"+b+"-2");h=h.options[h.selectedIndex].value;var j=$id("el-s-sizefilter-"+b+"-2").value;var k=$id("el-s-sizeunit-"+b+"-2");k=k.options[k.selectedIndex].value}var a=$nm("el-s-chkbx-"+b);var n=a.length;for(var i=0;i<n;i++){a[i].checked=(this.test(d,this.getName(a[i].value))&&this.testSize(this.getSize(a[i].value),e,f,g)&&this.testSize(this.getSize(a[i].value),h,j,k))?true:false}},setChktype:function(a){var b=$nm("el-s-chktype-"+a);var c=$id("el-s-namefilter-"+a).value;var n=b.length;var d,str;for(var i=0;i<n;i++){str=b[i].value;d=new RegExp("\\."+str+"\\$","i");b[i].checked=d.test(c)?true:false}},typeFilter:function(a,b,c){var d=$id("el-s-namefilter-"+a);var e=$nm("el-s-chktype-"+a);var n=e.length;var f=/(\.\S+?\$)(\|\.\S+?\$)*/gi;var g=new RegExp("\\|\\."+b+"\\$|\\."+b+"\\$\\||\\."+b+"\\$","i");d.value=d.value.replace(g,"");if(c){if(f.test(d.value)){d.value=d.value.replace(f,"$&|."+b+"$")}else{if(d.value!==""&&d.value.substr(d.value.length-1,1)!=" "){d.value+=" "}d.value+="."+b+"$"}}this.filterRun(a);this.total(a)},exe:function(){if(window.addEventListener){window.addEventListener("load",ed2kls.init,false)}else if(window.attachEvent){window.attachEvent("onload",ed2kls.init)}},init:function(){var a=$cl("el-s-namefilter","input",document).concat($cl("el-s-sizefilter","input",document));for(var i=0;i<a.length;i++){a[i].value=""}}};ed2kls.cb.exe();ed2kls.exe();